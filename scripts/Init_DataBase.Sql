/********************************************************************************************
    Project: Modern Data Warehouse Setup
    Author: Vikas Sharma
    Description:
        This script creates a structured SQL Server Data Warehouse environment
        following the multi-layered architecture pattern:
            ‚Ä¢ Bronze ‚Äì Raw/ingested data
            ‚Ä¢ Silver ‚Äì Cleaned and transformed data
            ‚Ä¢ Gold ‚Äì Curated, analytics-ready data

    Version: 1.0
    Date Created: 2025-11-06

    ----------------------------------------------------------------------------------------
    ‚ö†Ô∏è WARNINGS & NOTES:
      ‚Ä¢ Run this script in SQL Server Management Studio (SSMS) with proper permissions.
      ‚Ä¢ Ensure you are NOT connected to a production environment before executing.
      ‚Ä¢ Modify database name if 'DataWareHouse' already exists.
      ‚Ä¢ Use this as part of your ETL / ELT setup.

********************************************************************************************/

-- Switch to master database (recommended before creating a new database)
USE master;
GO

----------------------------------------------------------------------------------------------
-- 1Ô∏è‚É£ Create the Data Warehouse database
----------------------------------------------------------------------------------------------
IF NOT EXISTS (SELECT name FROM sys.databases WHERE name = 'DataWareHouse')
BEGIN
    PRINT('‚úÖ Creating database: DataWareHouse...');
    CREATE DATABASE DataWareHouse;
END
ELSE
BEGIN
    PRINT('‚ö†Ô∏è Database [DataWareHouse] already exists. Skipping creation.');
END
GO

----------------------------------------------------------------------------------------------
-- 2Ô∏è‚É£ Switch to the newly created Data Warehouse
----------------------------------------------------------------------------------------------
USE DataWareHouse;
GO

----------------------------------------------------------------------------------------------
-- 3Ô∏è‚É£ Create Schemas for Multi-Layered Architecture
----------------------------------------------------------------------------------------------

-- üîπ Bronze Layer: Raw / Staging Area
IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'bronze')
BEGIN
    EXEC('CREATE SCHEMA bronze');
    PRINT('‚úÖ Schema [bronze] created successfully.');
END
ELSE
BEGIN
    PRINT('‚ö†Ô∏è Schema [bronze] already exists.');
END
GO

-- üî∏ Silver Layer: Cleaned / Transformed Data
IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'silver')
BEGIN
    EXEC('CREATE SCHEMA silver');
    PRINT('‚úÖ Schema [silver] created successfully.');
END
ELSE
BEGIN
    PRINT('‚ö†Ô∏è Schema [silver] already exists.');
END
GO

-- üü° Gold Layer: Curated / Analytics-Ready Data
IF NOT EXISTS (SELECT * FROM sys.schemas WHERE name = 'gold')
BEGIN
    EXEC('CREATE SCHEMA gold');
    PRINT('‚úÖ Schema [gold] created successfully.');
END
ELSE
BEGIN
    PRINT('‚ö†Ô∏è Schema [gold] already exists.');
END
GO

----------------------------------------------------------------------------------------------
-- ‚úÖ Summary
----------------------------------------------------------------------------------------------
PRINT('üéØ Data Warehouse setup completed successfully!');
PRINT('   Database: DataWareHouse');
PRINT('   Schemas: bronze, silver, gold');
GO
